{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@foskym/flarum-pagination/webpack/bootstrap","webpack://@foskym/flarum-pagination/webpack/runtime/compat get default export","webpack://@foskym/flarum-pagination/webpack/runtime/define property getters","webpack://@foskym/flarum-pagination/webpack/runtime/hasOwnProperty shorthand","webpack://@foskym/flarum-pagination/webpack/runtime/make namespace object","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['common/app']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['common/extend']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['forum/components/DiscussionComposer']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['forum/utils/DiscussionControls']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['forum/app']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['forum/components/SettingsPage']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['common/components/FieldSet']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['common/utils/ItemList']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['common/components/Switch']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['common/utils/Stream']\"","webpack://@foskym/flarum-pagination/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['forum/states/DiscussionListState']\"","webpack://@foskym/flarum-pagination/./src/forum/overrideDiscussionListState.js","webpack://@foskym/flarum-pagination/./src/forum/utils/determineMode.ts","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['forum/components/DiscussionList']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['forum/components/DiscussionListItem']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['common/utils/classList']\"","webpack://@foskym/flarum-pagination/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['common/Component']\"","webpack://@foskym/flarum-pagination/external root \"flarum.core.compat['common/components/Button']\"","webpack://@foskym/flarum-pagination/./src/forum/components/Toolbar.tsx","webpack://@foskym/flarum-pagination/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@foskym/flarum-pagination/./src/forum/overrideDiscussionList.js","webpack://@foskym/flarum-pagination/./src/forum/index.js","webpack://@foskym/flarum-pagination/./src/forum/addUserPreference.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionComposer'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/utils/DiscussionControls'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/SettingsPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/FieldSet'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/ItemList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Switch'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/Stream'];","export default function _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/states/DiscussionListState'];","import app from 'flarum/common/app';\nimport { override } from 'flarum/common/extend';\nimport DiscussionListState from 'flarum/forum/states/DiscussionListState';\nimport Stream from 'flarum/common/utils/Stream';\nimport determineMode from './utils/determineMode';\n\n/* -------------------- 路由/URL 工具 -------------------- */\nfunction getPageFromURL() {\n  try {\n    const p = new URL(window.location.href).searchParams.get('page');\n    const n = parseInt(p, 10);\n    return Number.isFinite(n) && n > 0 ? n : null;\n  } catch { return null; }\n}\nfunction setPageToURL(n, replace = true) {\n  try {\n    const u = new URL(window.location.href);\n    if (n <= 1) u.searchParams.delete('page');\n    else u.searchParams.set('page', String(n));\n    const newUrl = u.pathname + u.search + u.hash;\n\n    const mAny = (window && window.m) || null;\n    if (mAny && mAny.route && typeof mAny.route.set === 'function') {\n      mAny.route.set(newUrl, undefined, { replace: true });\n    } else {\n      (replace ? history.replaceState : history.pushState).call(history, null, '', newUrl);\n    }\n  } catch {}\n}\nfunction routeKey() {\n  try {\n    const mAny = (window && window.m) || null;\n    if (mAny?.route?.get) return String(mAny.route.get());\n  } catch {}\n  return location.pathname + location.search + (location.hash || '');\n}\n\n/* -------- “从帖子返回”标记：每次回退都当作首次挂载 -------- */\nconst PENDING_BACK_KEY = 'lbtc:dl:pendingBack';\nif (!window.__dlBackMarkerInstalled) {\n  window.__dlBackMarkerInstalled = true;\n  document.addEventListener('click', (ev) => {\n    const target = ev.target;\n    const a = target && (target.closest?.('a[href*=\"/d/\"]'));\n    if (a) {\n      try {\n        sessionStorage.setItem(PENDING_BACK_KEY, JSON.stringify({ t: Date.now(), base: routeKey() }));\n      } catch {}\n      // 离开前保存锚点（见下）\n      saveAnchorBeforeLeave();\n    }\n  }, { capture: true, passive: true });\n}\nfunction consumePendingBackForCurrentRoute() {\n  try {\n    const raw = sessionStorage.getItem(PENDING_BACK_KEY);\n    if (!raw) return false;\n    const obj = JSON.parse(raw);\n    const ok = obj && obj.base === routeKey() && Date.now() - (obj.t || 0) < 10 * 60 * 1000;\n    if (ok) sessionStorage.removeItem(PENDING_BACK_KEY);\n    return !!ok;\n  } catch { return false; }\n}\n\n/* -------------------- 锚点保存/恢复（用于“不滚回”） -------------------- */\nconst ANCHOR_KEY_PREFIX = 'lbtc:dl:anchor:';\nfunction headerOffsetGuess() {\n  const el = document.querySelector('.App-header, .Header, #header, header');\n  return el ? Math.max(0, el.getBoundingClientRect().height - 4) : 0;\n}\nfunction anchorStorageKey() {\n  return ANCHOR_KEY_PREFIX + (location.pathname + location.search + (location.hash || ''));\n}\nfunction saveAnchorBeforeLeave() {\n  try {\n    const items = Array.from(document.querySelectorAll('li.DiscussionListItem'));\n    const topEdge = headerOffsetGuess();\n    let topEl = null, minTop = Infinity;\n\n    for (const li of items) {\n      const r = li.getBoundingClientRect();\n      if (r.bottom <= topEdge) continue;\n      if (r.top >= topEdge && r.top < minTop) { topEl = li; minTop = r.top; }\n    }\n\n    let id, href, y = window.scrollY || document.documentElement.scrollTop || 0;\n    if (topEl) {\n      id = topEl.getAttribute('data-id') || undefined;\n      const a = topEl.querySelector('a[href*=\"/d/\"]'); href = a?.getAttribute('href') || undefined;\n    }\n    sessionStorage.setItem(anchorStorageKey(), JSON.stringify({ id, href, y, t: Date.now() }));\n  } catch {}\n}\nfunction parseAnchor() {\n  try {\n    const raw = sessionStorage.getItem(anchorStorageKey());\n    if (!raw) return null;\n    const s = JSON.parse(raw);\n    if (!s || typeof s !== 'object') return null;\n    return s;\n  } catch { return null; }\n}\nfunction findTargetElementByAnchor(anchor) {\n  if (!anchor) return null;\n  if (anchor.id) {\n    const el = document.querySelector(`li.DiscussionListItem[data-id=\"${anchor.id}\"]`);\n    if (el) return el;\n  }\n  if (anchor.href) {\n    const m = anchor.href.match(/\\/d\\/(\\d+)/);\n    if (m) {\n      const el = document.querySelector(`li.DiscussionListItem a[href*=\"/d/${m[1]}\"]`)?.closest('li.DiscussionListItem');\n      if (el) return el;\n    }\n  }\n  return null;\n}\nfunction restoreScrollFromAnchor(anchor) {\n  if (!anchor) return;\n  const offset = headerOffsetGuess();\n  const targetEl = findTargetElementByAnchor(anchor);\n  if (targetEl) {\n    const y = window.scrollY + targetEl.getBoundingClientRect().top - offset - 8;\n    requestAnimationFrame(() => window.scrollTo(0, Math.max(0, y)));\n    return;\n  }\n  if (typeof anchor.y === 'number') {\n    let tries = 0;\n    const max = 40;\n    const tick = () => {\n      const h = document.documentElement.scrollHeight || document.body.scrollHeight || 0;\n      if (h > anchor.y + 50 || tries >= max) {\n        requestAnimationFrame(() => window.scrollTo(0, Math.max(0, anchor.y - Math.max(0, offset))));\n      } else { tries++; setTimeout(tick, 50); }\n    };\n    tick();\n  }\n}\n// 暴露给视图层（用于 oncreate 中“瞬移到锚点”）\nwindow.__dlRestoreFromAnchor = restoreScrollFromAnchor;\n\n/* -------------------- 会话级页面缓存（回退直出） -------------------- */\nfunction buildSessionKey(state, page) {\n  try {\n    const req = state.requestParams ? state.requestParams() : {};\n    const base = location.pathname;\n    const keyObj = {\n      base,\n      include: req.include || [],\n      filter: req.filter || {},\n      sort: req.sort || null,\n      perPage: state.options?.perPage || 20,\n      page: Number(page) || 1,\n    };\n    return 'lbtc:dl:pagecache:' + JSON.stringify(keyObj);\n  } catch { return null; }\n}\nfunction savePageCache(state, page, results) {\n  try {\n    const key = buildSessionKey(state, page);\n    if (!key) return;\n    const ids = Array.isArray(results) ? results.map((d) => d && d.id && d.id()) : [];\n    const total =\n      (state.totalDiscussionCount && state.totalDiscussionCount()) ||\n      (results && results.payload && results.payload.jsonapi && results.payload.jsonapi.totalResultsCount) ||\n      0;\n    const record = { ids, total, ts: Date.now(), perPage: state.options?.perPage || 20 };\n    sessionStorage.setItem(key, JSON.stringify(record));\n  } catch {}\n}\nfunction tryRestoreFromSession(state, page) {\n  try {\n    const key = buildSessionKey(state, page);\n    if (!key) return null;\n    const raw = sessionStorage.getItem(key);\n    if (!raw) return null;\n\n    const rec = JSON.parse(raw);\n    if (!rec || !Array.isArray(rec.ids) || !rec.ids.length) return null;\n\n    const type = state.type || 'discussions';\n    const models = [];\n    for (const id of rec.ids) {\n      const model =\n        (app.store.getById && app.store.getById(type, id)) ||\n        (app.store.getBy && app.store.getBy(type, 'id', id)) ||\n        null;\n      if (!model) return null; // 缺任一条则放弃会话恢复\n      models.push(model);\n    }\n\n    const totalPages = Math.ceil((rec.total || 0) / (rec.perPage || state.options?.perPage || 20));\n    const links = {};\n    if (page > 1) links.prev = true;\n    if (page < totalPages) links.next = true;\n\n    const results = models;\n    results.payload = { jsonapi: { totalResultsCount: rec.total || 0 }, links };\n    return results;\n  } catch { return null; }\n}\nfunction invalidateSessionPage(state, page) {\n  try {\n    const key = buildSessionKey(state, page);\n    if (key) sessionStorage.removeItem(key);\n  } catch {}\n}\n\n/* -------------------- 主逻辑 -------------------- */\nexport default function () {\n  // 初始化分页选项\n  DiscussionListState.prototype.initOptions = function () {\n    this.options = {\n      cacheDiscussions: app.forum.attribute('foskym-pagination.cacheDiscussions'),\n      perPage: app.forum.attribute('foskym-pagination.perPage'),\n      perLoadMore: app.forum.attribute('foskym-pagination.perLoadMore'),\n      perIndexInit: app.forum.attribute('foskym-pagination.perIndexInit'),\n      leftEdges: 4,\n      rightEdges: 5,\n    };\n    this.usePaginationMode = determineMode();\n    this.lastTotalDiscussionCount = 0;\n    this.lastTotalPages = 0;\n    this.lastDiscussions = [];\n    this.lastLoadedPage = {};\n    this.lastRequestParams = {};\n    this.optionInitialized = true;\n\n    // 第一次 refreshParams 标记（用于区分冷启动/回退 vs 后续黄条）\n    this.__paramsRefreshedOnce = false;\n  };\n\n  /**\n   * 参数刷新：\n   * - 若检测到“从帖子返回”的标记 → 当作首次挂载处理：尊重 URL ?page，不绕过会话缓存（静默直出）\n   * - 否则：\n   *   - 第一次触发：同上（兼容冷启动/直接访问）\n   *   - 后续触发（黄条、切换排序/筛选）：回到第1页，绕过一次会话缓存（强制网络）\n   */\n  override(DiscussionListState.prototype, 'refreshParams', function (original, params, page = 1) {\n    const ret = original(params, page);\n    if (!this.usePaginationMode || typeof this.refresh !== 'function') return ret;\n\n    const back = consumePendingBackForCurrentRoute();\n    const first = !this.__paramsRefreshedOnce;\n\n    if (back || first) {\n      this.__paramsRefreshedOnce = true;\n      const goPage = getPageFromURL() ?? (page ?? 1);\n      return Promise.resolve(ret).then(() => this.refresh(goPage));\n    }\n\n    // 黄条/后续：强制到第1页 + 绕过一次会话缓存\n    const goPage = 1;\n    this.__bypassSessionOnce = true;\n    invalidateSessionPage(this, goPage);\n    return Promise.resolve(ret).then(() => this.refresh(goPage));\n  });\n\n  // 刷新指定页（含：会话缓存直出 + 首帧静默 + URL 同步；支持一次性绕过）\n  override(DiscussionListState.prototype, 'refresh', function (original, page = 1) {\n    if (!this.optionInitialized) this.initOptions();\n\n    if (!this.usePaginationMode) {\n      this.pageSize = this.options.perLoadMore;\n      return original(page);\n    }\n\n    let targetPage = page;\n    if (targetPage === undefined || targetPage === 1) {\n      const u = getPageFromURL();\n      if (u) targetPage = u;\n    }\n\n    // 会话缓存直出（不发请求）——但允许被一次性绕过\n    if (!this.__bypassSessionOnce) {\n      const sessionResults = tryRestoreFromSession(this, targetPage);\n      if (sessionResults) {\n        this.silentRestoreOnce = true; // 首帧去 Loading\n\n        this.initialLoading = false;\n        this.loadingPrev = false;\n        this.loadingNext = false;\n        this.isRefreshing = false;\n\n        this.location = { page: targetPage };\n        setPageToURL(targetPage, true);\n\n        this.pages = [];\n        this.parseResults(this.location.page, sessionResults);\n\n        if (typeof m !== 'undefined' && m.redraw) m.redraw();\n\n        // ★ 为“看起来不滚回”：交给视图隐藏首帧并瞬移到锚点\n        const anchor = parseAnchor();\n        if (anchor) {\n          this.__pendingAnchor = anchor;\n          this.__hideListOnce = true;\n        }\n\n        setTimeout(() => (this.silentRestoreOnce = false), 0);\n        return Promise.resolve(sessionResults);\n      }\n    }\n    // 用完即清\n    this.__bypassSessionOnce = false;\n\n    this.initialLoading = true;\n    this.loadingPrev = false;\n    this.loadingNext = false;\n    this.isRefreshing = true;\n\n    this.clear();\n    this.location = { page: targetPage };\n    setPageToURL(targetPage, true);\n\n    return this.loadPage(targetPage)\n      .then((results) => {\n        this.pages = [];\n        this.parseResults(this.location.page, results);\n      })\n      .finally(() => {\n        this.initialLoading = false;\n        this.isRefreshing = false;\n      });\n  });\n\n  // 加载某页\n  override(DiscussionListState.prototype, 'loadPage', function (original, page = 1) {\n    const reqParams = this.requestParams();\n    if (!this.optionInitialized) this.initOptions();\n\n    if (!this.lastRequestParams['include']) {\n      this.lastRequestParams = reqParams;\n    }\n\n    const preloadedDiscussions = app.preloadedApiDocument();\n    if (preloadedDiscussions) {\n      this.initialLoading = false;\n      this.isRefreshing = false;\n      this.totalDiscussionCount = Stream(preloadedDiscussions.payload.jsonapi.totalResultsCount);\n      this.lastTotalDiscussionCount = this.totalDiscussionCount();\n      return Promise.resolve(preloadedDiscussions);\n    }\n\n    // 本地缓存复用（参数未变）\n    if (!this.isRefreshing && this.options.cacheDiscussions) {\n      const includeChanged = JSON.stringify(reqParams['include']) !== JSON.stringify(this.lastRequestParams['include']);\n      const filterChanged  = JSON.stringify(reqParams['filter'])  !== JSON.stringify(this.lastRequestParams['filter']);\n      const sortChanged    = reqParams['sort'] !== this.lastRequestParams['sort'];\n\n      if (!(includeChanged || filterChanged || sortChanged)) {\n        if (this.lastLoadedPage[page]) {\n          const start = this.options.perPage * (page - 1);\n          const end = this.options.perPage * page;\n          const results = this.lastDiscussions.slice(start, end);\n          results.payload = { jsonapi: { totalResultsCount: this.totalDiscussionCount() } };\n\n          this.initialLoading = true;\n          if (typeof m !== 'undefined' && m.redraw) m.redraw();\n          return new Promise((resolve) => setTimeout(() => resolve(results), 50));\n        }\n      }\n    }\n\n    const include = Array.isArray(reqParams.include) ? reqParams.include.join(',') : reqParams.include;\n\n    let newOffset, newLimit;\n    if (this.usePaginationMode) {\n      newOffset = this.options.perPage * (page - 1);\n      newLimit = this.options.perPage;\n    } else {\n      newOffset = this.options.perIndexInit * Math.min(page - 1, 1) + this.options.perLoadMore * Math.max(page - 2, 0);\n      newLimit = newOffset === 0 ? this.options.perIndexInit : this.options.perLoadMore;\n    }\n\n    const params = {\n      ...reqParams,\n      page: { ...reqParams.page, offset: newOffset, limit: newLimit },\n      include,\n    };\n\n    return app.store.find(this.type, params);\n  });\n\n  // cards 兼容：拿所有 items\n  override(DiscussionListState.prototype, 'getAllItems', function (original) {\n    if (!('walsgit-discussion-cards' in flarum.extensions)) return original();\n    return this.extraDiscussions.concat(this.getPages(true).map((pg) => pg.items).flat());\n  });\n\n  // cards 兼容：仅返回当前页（或所有页）\n  override(DiscussionListState.prototype, 'getPages', function (original, getAllPages = false) {\n    const allPages = original();\n    if (!('walsgit-discussion-cards' in flarum.extensions)) return allPages;\n    if (getAllPages) return allPages;\n    return [allPages.find((page) => page.number === this.location.page)];\n  });\n\n  // 解析结果并更新分页状态（保存会话缓存）\n  override(DiscussionListState.prototype, 'parseResults', function (original, pg, results) {\n    if (!this.usePaginationMode) return original(pg, results);\n\n    const pageNum = Number(pg);\n    const links = results.payload?.links || {};\n    const page = { number: pageNum, items: results, hasNext: !!links?.next, hasPrev: !!links?.prev };\n\n    this.hasPage = function (num) {\n      const all = this.getPages(true);\n      if (all.length === 0) return false;\n      return all.some((p) => p.number === num);\n    };\n\n    if (!this.hasPage(pageNum)) this.pages.push(page);\n    this.pages = this.pages.sort((a, b) => a.number - b.number);\n    this.location = { page: pageNum };\n\n    this.totalDiscussionCount = Stream(results.payload.jsonapi.totalResultsCount);\n\n    if (this.options.cacheDiscussions) {\n      if (\n        (this.lastTotalDiscussionCount !== this.totalDiscussionCount() && this.lastTotalDiscussionCount !== 0) ||\n        this.lastTotalDiscussionCount === 0 ||\n        this.isRefreshing\n      ) {\n        this.lastTotalDiscussionCount = this.totalDiscussionCount();\n        this.lastDiscussions = new Array(this.lastTotalDiscussionCount);\n        this.lastLoadedPage = {};\n      } else {\n        this.lastLoadedPage[pageNum] = page;\n        const start = this.options.perPage * (pageNum - 1);\n        const end = this.options.perPage * pageNum;\n        this.lastDiscussions.splice(start, end - start, ...results);\n      }\n    }\n\n    this.getTotalPages = function () {\n      return Math.ceil(this.totalDiscussionCount() / this.options.perPage);\n    };\n\n    this.page = Stream(page);\n    this.perPage = Stream(this.options.perPage);\n    this.totalPages = Stream(this.getTotalPages());\n\n    // 保存本页到会话缓存（供回退直出）\n    savePageCache(this, pageNum, results);\n\n    this.ctrl = {\n      scrollToTop: function () {\n        const container = document.querySelector('#content > .IndexPage > .container');\n        const header = document.querySelector('#header');\n        let offsetY = 0;\n        if (header) offsetY = header.clientHeight;\n        if (container) {\n          const target = container.getBoundingClientRect().top + window.scrollY - offsetY;\n          setTimeout(() => window.scrollTo({ top: target, behavior: 'smooth' }), 50);\n        }\n      }.bind(this),\n\n      prevPage: function () {\n        let current = this.page().number - 1;\n        if (current < 1) return;\n        this.page(current);\n        this.loadingPrev = true;\n        this.loadPage(current).then((r) => {\n          this.parseResults(current, r);\n          this.loadingPrev = false;\n          setPageToURL(current, true);\n          this.ctrl.scrollToTop();\n        });\n      }.bind(this),\n\n      nextPage: function () {\n        let current = this.page().number + 1;\n        if (current > this.totalPages()) {\n          current = this.totalPages();\n          return;\n        }\n        this.page(current);\n        this.loadingNext = true;\n        this.loadPage(current).then((r) => {\n          this.parseResults(current, r);\n          this.loadingNext = false;\n          setPageToURL(current, true);\n          this.ctrl.scrollToTop();\n        });\n      }.bind(this),\n\n      toPage: function (page) {\n        const target = Number(page);\n        if (this.page().number === target || target < 1 || target > this.totalPages()) return;\n        this.page(target);\n        this.initialLoading = true;\n        this.loadPage(target).then((r) => {\n          this.parseResults(target, r);\n          this.initialLoading = false;\n          setPageToURL(target, true);\n          this.ctrl.scrollToTop();\n        });\n      }.bind(this),\n\n      pageList: function () {\n        const p = [];\n        const left = Math.max(parseInt(this.page().number) - this.options.leftEdges, 1);\n        const right = Math.min(parseInt(this.page().number) + this.options.rightEdges, this.totalPages());\n        for (let i = left; i <= right; i++) p.push(i);\n        return p;\n      }.bind(this),\n    };\n\n    if (typeof m !== 'undefined' && m.redraw) m.redraw();\n  });\n\n  // Realtime：倒计时结束 → 刷新第 1 页，但绕过一次会话缓存，确保拉到最新数据\n  override(DiscussionListState.prototype, 'addDiscussion', function (original, discussion) {\n    if (!this.usePaginationMode) return original(discussion);\n\n    clearTimeout(this.__rtRefreshTimer);\n    this.__rtRefreshTimer = setTimeout(() => {\n      this.page = this.page || Stream({ number: 1, items: [] });\n      this.location = { page: 1 };\n      this.__bypassSessionOnce = true;\n      invalidateSessionPage(this, 1);\n      this.refresh(1);\n    }, 50);\n\n    const index = this.lastDiscussions.indexOf(discussion);\n    if (index !== -1) {\n      this.lastDiscussions.splice(index);\n      this.lastDiscussions.unshift(discussion);\n    } else {\n      this.lastDiscussions.unshift(discussion);\n      this.lastTotalDiscussionCount++;\n      this.totalDiscussionCount(this.lastTotalDiscussionCount);\n    }\n    if (typeof m !== 'undefined' && m.redraw) m.redraw();\n  });\n\n  override(DiscussionListState.prototype, 'deleteDiscussion', function (original, discussion) {\n    if (!this.usePaginationMode) return original(discussion);\n    const index = this.lastDiscussions.indexOf(discussion);\n    if (index !== -1) {\n      this.lastDiscussions.splice(index);\n      this.lastTotalDiscussionCount--;\n      this.totalDiscussionCount(this.lastTotalDiscussionCount);\n    }\n    if (typeof m !== 'undefined' && m.redraw) m.redraw();\n  });\n\n  // 清理状态\n  override(DiscussionListState.prototype, 'clear', function (original) {\n    if (!this.usePaginationMode) return original();\n    this.lastDiscussions = [];\n    this.lastLoadedPage = {};\n    this.lastRequestParams = {};\n    this.lastTotalDiscussionCount = 0;\n    this.lastTotalPages = 0;\n    this.totalDiscussionCount = Stream(0);\n    return original();\n  });\n}\n","import app from 'flarum/forum/app';\n\nexport default function () {\n  if (app.session.user === null) {\n    return app.forum.attribute('foskym-pagination.paginationOnLoading');\n  }\n\n  const preferences = app.session.user.preferences() as any;\n\n  if (app.forum.attribute('foskym-pagination.canUserPref')) {\n    if (!preferences['foskym-pagination.userCustom']) {\n      return app.forum.attribute('foskym-pagination.paginationOnLoading');\n    } else {\n      if (!preferences['foskym-pagination.userPaginationOnLoading']) {\n        return false;\n      }\n    }\n  } else {\n    return app.forum.attribute('foskym-pagination.paginationOnLoading');\n  }\n\n  return true;\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionListItem'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/classList'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","import Component from 'flarum/common/Component';\nimport Button from 'flarum/common/components/Button';\nimport type Mithril from 'mithril';\n\nexport default class Toolbar extends Component {\n  attrs: any;\n  view(vnode: Mithril.Vnode) {\n    let state = this.attrs.state;\n    return (\n      <div className=\"Pagination\">\n        <ul class=\"IndexPage-toolbar-view\">\n          <li>{this.buttonFirst()}</li>\n          <li>{this.buttonBack()}</li>\n          {state.ctrl.pageList().map((page: any) => {\n            return (\n              <li>\n                <Button\n                  title={page}\n                  className={state.page().number == page ? 'Button Button--primary Button--active' : 'Button'}\n                  onclick={() => {\n                    state.ctrl.toPage(page);\n                  }}\n                >\n                  {page}\n                </Button>\n              </li>\n            );\n          })}\n          <li>{this.buttonNext()}</li>\n          <li>{this.buttonLast()}</li>\n          <li>{this.inputJump()}</li>\n          <li>{this.buttonJump()}</li>\n        </ul>\n      </div>\n    );\n  }\n\n  buttonFirst() {\n    let state = this.attrs.state;\n    return Button.component({\n      title: 'First',\n      icon: 'fa fa-angle-double-left fas fa-angles-left',\n      className: 'Button Button--icon',\n      onclick: () => {\n        state.ctrl.toPage(1);\n      },\n      disabled: state.page().number == 1,\n    });\n  }\n\n  buttonBack() {\n    let state = this.attrs.state;\n    return Button.component({\n      title: 'Back',\n      icon: 'fa fa-angle-left fas',\n      className: 'Button Button--icon',\n      onclick: () => {\n        let page = state.page().number;\n        state.ctrl.toPage(parseInt(page) - 1);\n      },\n      disabled: state.page().number == 1,\n    });\n  }\n\n  buttonNext() {\n    let state = this.attrs.state;\n    return Button.component({\n      title: 'Next',\n      icon: 'fa fa-angle-right fas',\n      className: 'Button Button--icon',\n      onclick: () => {\n        let page = state.page().number;\n        state.ctrl.toPage(parseInt(page) + 1);\n      },\n      disabled: state.page().number == state.totalPages(),\n    });\n  }\n\n  buttonLast() {\n    let state = this.attrs.state;\n    return Button.component({\n      title: 'Last',\n      icon: 'fa fa-angle-double-right fas fa-angles-right',\n      className: 'Button Button--icon',\n      onclick: () => {\n        let page = parseInt(state.totalPages());\n        state.ctrl.toPage(page);\n      },\n      disabled: state.page().number == state.totalPages(),\n    });\n  }\n\n  JumpFunc() {\n    let state = this.attrs.state;\n    let input = parseInt(document.getElementById('pagination-inputJump')?.value);\n    if (Number.isFinite(input) && Number.isSafeInteger(input)) {\n      if (input != state.page().number) {\n        if (1 <= input && input <= state.totalPages()) {\n          state.ctrl.toPage(input);\n        }\n      }\n    }\n  }\n\n  inputJump() {\n    let state = this.attrs.state;\n    return m('input.FromControl', {\n      id: 'pagination-inputJump',\n      placeholder: state.page().number === undefined ? '' : `${state.page().number}`,\n      onkeydown: (event: KeyboardEvent) => {\n        event.redraw = false;\n        if (event.keyCode == 13) {\n          event.redraw = true;\n          this.JumpFunc();\n        }\n      },\n    });\n  }\n\n  buttonJump() {\n    return Button.component({\n      title: 'Jump',\n      icon: 'fa fa-paper-plane fas',\n      className: 'Button Button--icon',\n      onclick: this.JumpFunc.bind(this),\n    });\n  }\n}\n","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","import app from 'flarum/common/app';\nimport { override } from 'flarum/common/extend';\nimport DiscussionList from 'flarum/forum/components/DiscussionList';\nimport DiscussionListItem from 'flarum/forum/components/DiscussionListItem';\nimport classList from 'flarum/common/utils/classList';\nimport Toolbar from './components/Toolbar';\n\n/**\n * 要点：\n * - 绝不新建第二个 <ul.DiscussionList-discussions>，只原位替换其 children。\n * - 删除其它空壳 UL；Toolbar 作为兄弟节点插入（上/下）。\n * - cards 模式不触碰 UL，只插 Toolbar。\n * - 静默恢复：当 state.silentRestoreOnce 为真时，去掉本帧的 LoadingIndicator。\n * - “不滚回”的视觉：state.__hideListOnce 为真时，本帧隐藏列表；\n *   oncreate 同帧用锚点瞬移到目标帖子，再显示列表。\n */\nexport default function () {\n  override(DiscussionList.prototype, 'view', function (original) {\n    const state = this.attrs?.state;\n    const tree = original();\n\n    // 根节点类\n    tree.attrs = tree.attrs || {};\n    tree.attrs.className = classList(\n      'DiscussionList',\n      { 'DiscussionList--searchResults': state?.isSearchResults?.() },\n      tree.attrs.className\n    );\n\n    // 静默恢复：移除本帧 LoadingIndicator\n    if (state?.silentRestoreOnce) {\n      const getClass = (attrs) => String((attrs && (attrs.className || attrs.class)) || '');\n      const isLoadingIndicator = (n) => n && typeof n === 'object' && n.attrs && getClass(n.attrs).includes('LoadingIndicator');\n      const childrenRef = (nodeOrArr) => {\n        if (Array.isArray(nodeOrArr)) return nodeOrArr;\n        if (nodeOrArr && Array.isArray(nodeOrArr.children)) return nodeOrArr.children;\n        return null;\n      };\n      (function strip(node) {\n        if (!node) return;\n        if (Array.isArray(node)) {\n          for (let i = node.length - 1; i >= 0; i--) {\n            const child = node[i];\n            if (isLoadingIndicator(child)) node.splice(i, 1);\n            else strip(child);\n          }\n          return;\n        }\n        if (typeof node === 'string' || typeof node === 'number') return;\n        const ch = childrenRef(node);\n        if (!ch) return;\n        for (let i = ch.length - 1; i >= 0; i--) {\n          const c = ch[i];\n          if (isLoadingIndicator(c)) ch.splice(i, 1);\n          else strip(c);\n        }\n      })(tree);\n    }\n\n    // ★ 不滚回：首帧隐藏 + oncreate 瞬移锚点后再显示\n    if (state?.__hideListOnce) {\n      const oldStyle = tree.attrs.style || '';\n      tree.attrs.style = (oldStyle ? oldStyle + ';' : '') + 'visibility:hidden';\n\n      const prevOncreate = tree.attrs.oncreate;\n      tree.attrs.oncreate = function (vnode) {\n        if (typeof prevOncreate === 'function') prevOncreate.call(this, vnode);\n        try {\n          if (window.__dlRestoreFromAnchor && state.__pendingAnchor) {\n            const docEl = document.documentElement;\n            const prev = docEl.style.scrollBehavior;\n            docEl.style.scrollBehavior = 'auto'; // 关闭平滑滚动，确保无“滚动感”\n            window.__dlRestoreFromAnchor(state.__pendingAnchor);\n            docEl.style.scrollBehavior = prev || '';\n          }\n        } catch {}\n        // 清理一次性标记并恢复可见\n        state.__pendingAnchor = null;\n        state.__hideListOnce = false;\n        // 下一帧显示\n        if (typeof m !== 'undefined' && m.redraw) m.redraw();\n      };\n    }\n\n    // 非分页模式/加载中/空列表：不改 UL\n    if (!state?.usePaginationMode || state.isLoading?.() || state.isEmpty?.()) {\n      return tree;\n    }\n\n    const cardSupport = 'walsgit-discussion-cards' in flarum.extensions;\n\n    // 取当前页 items\n    const pageSize = state.options?.perPage || 0;\n    const pageNum = state.page || 1;\n    const params = state.getParams?.() || {};\n    const allPages = state.getPages ? state.getPages(true) : [];\n    let items = [];\n    if (Array.isArray(allPages) && allPages.length) {\n      const curr = allPages.find(p => p?.number === state.location?.page) || allPages[0];\n      if (curr && Array.isArray(curr.items)) items = curr.items;\n    }\n\n    const liChildren = items.length\n      ? items.map((discussion, itemNum) => (\n          <li\n            key={discussion.id()}\n            data-id={discussion.id()}\n            role=\"article\"\n            aria-setsize={-1}\n            aria-posinset={(pageNum * pageSize) + itemNum}\n          >\n            <DiscussionListItem discussion={discussion} params={params} />\n          </li>\n        ))\n      : null;\n\n    // 工具\n    const getClass = (attrs) => String((attrs && (attrs.className || attrs.class)) || '');\n    const isUlList = (n) => n && n.tag === 'ul' && getClass(n.attrs).includes('DiscussionList-discussions');\n    const childrenRef = (nodeOrArr) => {\n      if (Array.isArray(nodeOrArr)) return nodeOrArr;\n      if (nodeOrArr && Array.isArray(nodeOrArr.children)) return nodeOrArr.children;\n      return null;\n    };\n\n    // 收集所有 UL\n    const uls = [];\n    (function walk(node, parent, indexInParent) {\n      if (!node) return;\n      if (Array.isArray(node)) {\n        for (let i = 0; i < node.length; i++) walk(node[i], node, i);\n        return;\n      }\n      if (typeof node === 'string' || typeof node === 'number') return;\n\n      if (isUlList(node)) uls.push({ node, parent, index: indexInParent });\n\n      const ch = childrenRef(node);\n      if (ch) for (let i = 0; i < ch.length; i++) walk(ch[i], node, i);\n    })(tree, null, null);\n\n    // cards：只插 Toolbar\n    if (cardSupport) {\n      insertToolbars(position(), tree, uls.length ? uls[0] : null, state);\n      return tree;\n    }\n\n    // 非 cards：原位替换 children，移除空壳 UL\n    if (uls.length > 0) {\n      let keep = uls.find(e => {\n        const ch = childrenRef(e.node);\n        return ch && ch.some(c => c && c.tag === 'li');\n      }) || uls.find(e => e.node?.attrs && 'aria-busy' in e.node.attrs) || uls[0];\n\n      if (liChildren) {\n        const ch = childrenRef(keep.node);\n        if (ch) { ch.splice(0, ch.length, ...liChildren); }\n        else { keep.node.children = liChildren; }\n      }\n\n      for (let i = uls.length - 1; i >= 0; i--) {\n        const e = uls[i];\n        if (e === keep) continue;\n        const parentArr = childrenRef(Array.isArray(e.parent) ? e.parent : e.parent);\n        if (!parentArr) continue;\n        const idx = e.index ?? parentArr.indexOf(e.node);\n        if (idx >= 0 && parentArr[idx] === e.node) {\n          const hasLi = (childrenRef(e.node) || []).some(c => c && c.tag === 'li');\n          if (!hasLi) parentArr.splice(idx, 1);\n        }\n      }\n\n      insertToolbars(position(), tree, keep, state);\n      return tree;\n    }\n\n    // 未找到 UL：不新增 UL，仅在根插 Toolbar\n    insertToolbars(position(), tree, null, state);\n    return tree;\n\n    function position() {\n      return app.forum.attribute('foskym-pagination.paginationPosition'); // 'above' | 'under' | 'both'\n    }\n\n    function insertToolbars(pos, rootTree, targetEntry, listState) {\n      const above = pos === 'above' || pos === 'both';\n      const under = pos === 'under' || pos === 'both';\n      if (!above && !under) return;\n\n      const toolbarVNode = Toolbar.component({ state: listState });\n\n      if (targetEntry && targetEntry.parent) {\n        const parent = targetEntry.parent;\n        const arr = childrenRef(Array.isArray(parent) ? parent : parent);\n        if (!arr) return;\n        let idx = targetEntry.index ?? arr.indexOf(targetEntry.node);\n        if (idx < 0) idx = 0;\n\n        if (above) arr.splice(idx, 0, toolbarVNode);\n        if (under) arr.splice(idx + (above ? 2 : 1), 0, toolbarVNode);\n      } else {\n        const rc = childrenRef(rootTree);\n        if (!rc) return;\n        if (above) rc.unshift(toolbarVNode);\n        if (under) rc.push(toolbarVNode);\n      }\n    }\n  });\n}\n","import app from 'flarum/common/app';\nimport { extend, override } from 'flarum/common/extend';\n\nimport DiscussionComposer from 'flarum/forum/components/DiscussionComposer';\nimport DiscussionControls from 'flarum/forum/utils/DiscussionControls';\n\nimport addUserPreference from './addUserPreference';\nimport overrideDiscussionListState from './overrideDiscussionListState';\nimport overrideDiscussionList from './overrideDiscussionList';\n\n\napp.initializers.add('foskym/flarum-pagination', () => {\n  addUserPreference();\n  overrideDiscussionListState();\n  overrideDiscussionList();\n\n  extend(DiscussionControls, 'deleteAction', function () {\n    if (!this.usePaginationMode) {\n      return;\n    }\n\n    if (app.discussions) {\n      let page = app.discussions.location.page;\n      app.discussions.refresh(page);\n    }\n  });\n\n  extend(DiscussionComposer.prototype, 'onsubmit', function () {\n    if (!this.usePaginationMode) {\n      return;\n    }\n\n    if (app.discussions) {\n      // let page = app.discussions.location.page;\n      app.discussions.refresh();\n    }\n  });\n}, -2); // load later to deal with `walsgit-discussion-cards`\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport SettingsPage from 'flarum/forum/components/SettingsPage';\nimport FieldSet from 'flarum/common/components/FieldSet';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport Switch from 'flarum/common/components/Switch';\nimport Stream from 'flarum/common/utils/Stream';\n\nexport default function () {\n  extend(SettingsPage.prototype, 'oninit', function () {\n    const user = this.user;\n    const preferences = user.preferences();\n    this.userCustom = Stream(preferences['foskym-pagination.userCustom']);\n    this.userPaginationOnLoading = Stream(preferences['foskym-pagination.userPaginationOnLoading']);\n  });\n\n  extend(SettingsPage.prototype, 'settingsItems', function (items) {\n    if (Boolean(app.forum.attribute('foskym-pagination.canUserPref'))) {\n      items.add(\n        'pagination_settings',\n        FieldSet.component(\n          {\n            label: app.translator.trans('foskym-pagination.forum.user.settings.head'),\n            className: 'SettingsPage-pagination',\n          },\n          this.Pagination_UserPrefItems().toArray()\n        )\n      );\n    }\n  });\n\n  SettingsPage.prototype['Pagination_UserPrefItems'] = function () {\n    const items = new ItemList();\n    items.add(\n      'foskym-pagination.userCustom',\n      Switch.component(\n        {\n          state: this.user.preferences()['foskym-pagination.userCustom'],\n          onchange: (value) => {\n            this.UserCustom_Loading = true;\n            this.user.savePreferences({ 'foskym-pagination.userCustom': value }).then(() => {\n              this.UserCustom_Loading = false;\n              m.redraw();\n            });\n          },\n          loading: this.UserCustom_Loading,\n        },\n        app.translator.trans('foskym-pagination.forum.user.settings.userCustom')\n      )\n    );\n\n    if (this.user.preferences()['foskym-pagination.userCustom']) {\n      items.add(\n        'foskym-pagination.userPaginationOnLoading',\n        Switch.component(\n          {\n            state: this.user.preferences()['foskym-pagination.userPaginationOnLoading'],\n            onchange: (value) => {\n              this.userPaginationOnLoading_Loading = true;\n              this.user.savePreferences({ 'foskym-pagination.userPaginationOnLoading': value }).then(() => {\n                this.userPaginationOnLoading_Loading = false;\n                m.redraw();\n              });\n            },\n            loading: this.userPaginationOnLoading_Loading,\n          },\n          app.translator.trans('foskym-pagination.forum.user.settings.userPaginationOnLoading')\n        )\n      );\n    }\n\n    return items;\n  };\n}\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","_extends","assign","bind","target","i","arguments","length","source","apply","this","getPageFromURL","p","URL","window","location","href","searchParams","n","parseInt","Number","isFinite","setPageToURL","replace","u","set","String","newUrl","pathname","search","hash","mAny","m","route","undefined","history","replaceState","pushState","routeKey","PENDING_BACK_KEY","headerOffsetGuess","el","document","querySelector","Math","max","getBoundingClientRect","height","anchorStorageKey","buildSessionKey","state","page","req","requestParams","keyObj","base","include","filter","sort","perPage","options","JSON","stringify","invalidateSessionPage","sessionStorage","removeItem","DiscussionListState","cacheDiscussions","app","perLoadMore","perIndexInit","leftEdges","rightEdges","usePaginationMode","preferences","determineMode","lastTotalDiscussionCount","lastTotalPages","lastDiscussions","lastLoadedPage","lastRequestParams","optionInitialized","__paramsRefreshedOnce","override","original","params","ret","refresh","back","raw","getItem","parse","ok","Date","now","t","consumePendingBackForCurrentRoute","first","goPage","Promise","resolve","then","__bypassSessionOnce","initOptions","pageSize","targetPage","sessionResults","rec","Array","isArray","ids","type","models","id","model","push","totalPages","ceil","total","links","prev","next","results","payload","jsonapi","totalResultsCount","tryRestoreFromSession","silentRestoreOnce","initialLoading","loadingPrev","loadingNext","isRefreshing","pages","parseResults","redraw","anchor","s","parseAnchor","__pendingAnchor","__hideListOnce","setTimeout","clear","loadPage","reqParams","preloadedDiscussions","totalDiscussionCount","Stream","includeChanged","filterChanged","sortChanged","start","end","slice","newOffset","newLimit","join","min","offset","limit","extensions","extraDiscussions","concat","getPages","map","pg","items","flat","getAllPages","allPages","find","number","pageNum","hasNext","hasPrev","hasPage","num","all","some","b","splice","getTotalPages","record","ts","setItem","savePageCache","ctrl","scrollToTop","container","header","offsetY","clientHeight","top","scrollY","scrollTo","behavior","prevPage","current","r","nextPage","toPage","pageList","left","right","discussion","clearTimeout","__rtRefreshTimer","index","indexOf","unshift","__dlBackMarkerInstalled","addEventListener","ev","closest","from","querySelectorAll","topEdge","topEl","minTop","Infinity","li","bottom","y","documentElement","scrollTop","getAttribute","saveAnchorBeforeLeave","capture","passive","__dlRestoreFromAnchor","targetEl","match","findTargetElementByAnchor","requestAnimationFrame","tries","tick","scrollHeight","body","_setPrototypeOf","setPrototypeOf","__proto__","Toolbar","subClass","superClass","attrs","create","constructor","view","vnode","className","class","buttonFirst","buttonBack","title","onclick","buttonNext","buttonLast","inputJump","buttonJump","Button","icon","disabled","JumpFunc","input","getElementById","isSafeInteger","placeholder","onkeydown","event","keyCode","Component","DiscussionList","tree","classList","isSearchResults","isLoadingIndicator","includes","strip","node","child","nodeOrArr","ch","children","c","oldStyle","style","prevOncreate","oncreate","docEl","scrollBehavior","isLoading","isEmpty","cardSupport","getParams","curr","liChildren","itemNum","role","childrenRef","uls","walk","parent","indexInParent","tag","insertToolbars","position","keep","e","parentArr","idx","pos","rootTree","targetEntry","listState","above","under","toolbarVNode","component","arr","rc","extend","SettingsPage","user","userCustom","userPaginationOnLoading","Boolean","add","FieldSet","label","Pagination_UserPrefItems","toArray","ItemList","Switch","onchange","UserCustom_Loading","savePreferences","loading","userPaginationOnLoading_Loading","overrideDiscussionListState","overrideDiscussionList","DiscussionControls","DiscussionComposer"],"sourceRoot":""}